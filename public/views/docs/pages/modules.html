<section id="overview">
  <h2>Packages Overview</h2>

  <p>The mean.io package system is a system allowing developers to create modular code that provides useful tools that other mean developers can use. The packages are plug and play and are used in a very similar way to traditional npm packages.</p>

	<p>The meanio npm package integrates all the packages into the mean project as if the code was part of mean itself and provides the developers with all the necceesary tools required to integrate their package into the host project.</p>

	<p>Packages are mini mean projects and follow similar desgign principles of a traditional mean app, without the overhead.</p>

	<p class="alert alert-info">The label <span class="label label-info">Abstraction</span> indicates functionality managed by the package system. packages</p>	
	<p class="alert alert-info">The label <span class="label label-info">Server</span> indicates server side code</p>
	<p class="alert alert-info">The label <span class="label label-info">Client</span> indicates client side code</p>	

</section>

<section id="first">
  <h2>Your First Package</h2>

	Mean.io comes with its own command line interface (CLI). The CLI provides a scaffolding function to create a default Package. 

	From the root of your mean project issue the following command

	<style>.ace_editor { height: 55px;font-size:16px;}</style>
	<div ui-ace="{ mode:'BatchFile', theme:'monokai', FontSize:'18px'}" readonly="true">
		mean package myPackage;
	</div>
		
	<p>Restart your app and login. You will notice a link in the main menu to an example page</p>

	<p class="alert alert-success">Congratulations you are now the official creator of a mean package!</p>	

</section>

<section id="using">
  <h2>Using Packages</h2>

	<p>Mean packages can be used in two ways </p>

	<ol>
		<li>To provide some service such as token generation, inline editing, theme changing</li>
		<li>As a tool/library for other packages or your general code base</li>
	</ol>

	<h3>Installing a package</h3>

	<p>We will use "mean-tokens" as an example.<p>

	<p>From the root of your mean project issue the following command.</p>

	<style>.ace_editor { height: 55px;font-size:16px;}</style>
	<div ui-ace="{ mode:'BatchFile', theme:'monokai', FontSize:'18px'}" readonly="true">
		mean install mean-tokens;
	</div>
		
	<p>Restart your app and login. You will notice a link in the main menu to an example page</p>

	<p class="alert alert-success">Congratulations you successfully installed your first package</p>

	<p class="alert alert-warning">Admin role is required to edit tokens. See the CLI section for how to assign roles to users or do <i>mean -h</i> from the command line</p>

</section>

<section id="fs">
	<h2>File Structure</h2>

	<p>The file structure is similar to that of the mean project itself</p>

	<p>Fundamental Files at the <strong>root</strong> of the package</p>

	<span class="label label-info">server</span>
	<pre>
	app.js        # Packages are registered here
	package.json  # Defines package name, version and <i>mean=true</i>
	</pre>

	<p>All of the Server side code resides in the <strong>/server</strong> directory.</p>

	<span class="label label-info">server</span>
	<pre>  
	Server 								
	--- config        # Configuration files
	--- controllers   # Server side logic goes here
	--- models        # Database Schema Models
	--- routes        # Rest api endpoints for routing
	--- views         # Swig based html rendering
	</pre>

	<p>All of the Client side code resides in the <strong>/public</strong> directory.</p>

	<span class="label label-info">client</span>
	<pre>
	public            # Anything in public is public assessible
	--- assets        # Javascript/Css/Images (not aggregated)
	--- controllers   # Angular Controllers
	--- config        # Contains routing files  						
	--- services      # Angular Services (there are also directive and filter folders)
	--- views         # Angular views
	</pre>
	
	<p class="alert alert-warning">All javascript within public is automatically aggregated with the exception of files in assets which can be manually added using the <i>aggregateAsset() </i> <span class="label label-info">abstraction</span> function</p>	

	<p class="alert alert-info">Files within public of the package can be accessed externally /[package-name]/path-to-file-relative-to-public for example to access tokens angular controller tokens/controllers/tokens.js</p>	

</section>	


<section id="register">
	<h2>Registering a Package</h2><span class="label label-info">Abstraction</span>|<span class="label label-info">Server</span>

	<p> </p>

	<p>In order for a Package to work it needs to be registered. By doing this you make package system aware that you are ready and that other packages are able to depend on you. The packages are registered from within <i>app.js</i></p>

	<p>When registering you are required to declare all your depencies in order for the package system to make them 
	available to your package.</p>

	<style>#register-example { height: 120px;font-size:16px;}</style>
	<div id="register-example"ui-ace="{ mode:'javascript', theme:'monokai'}" readonly="true">
	// Example of registering the MyPackage
	MyPackage.register(function(app, auth, database) {			

	});
	</div>

	<p>MEAN has 3 pre registered dependencies. <i>app</i> which makes the express app available <i>auth</i> which has some basic authentication functions and <i>database</i> which contains the mongoose database connection.</p>

	<p class="alert alert-warning">All dependencies specified must be registered in order to use them</p>	
	
</section>

<section id="dependencies">
	<h2>Dependency Injection</h2><span class="label label-info">Abstraction</span>|<span class="label label-info">Server</span>

	<p><blockquote><i>An injection is the passing of a dependency (a service) to a dependent object (a client). The service is made part of the client's state. Passing the service to the client, rather than allowing a client to build or find the service, is the fundamental requirement of the pattern.<a href="http://en.wikipedia.org/wiki/Dependency_injection">wikipedia</a></i></blockquote></p>

	<p>Dependency injection allows you to declare what dependencies you require and rely on the package system to resolve all dependencies for you. Any package registered is automatically made available to anyone who would like to depend on them</p>

	<p>Looking again at the registration example we can see that MyPackage depends on the Tokens and can 
	make use of it full functionality including overriding it</p>

	<style>#dependency-example { height: 220px;font-size:16px;}</style>
	<div id="dependency-example"ui-ace="{ mode:'javascript', theme:'monokai'}" readonly="true">
	// Example of registering the tokens package
	MyPackage.register(function(app, auth, database, Tokens) {			
		//I can make use of the tokens within my module
		MyPackage.someExampleFunction('some paramater');

		//I can overide functions
		MyPackage.someExampleFunction = function(param) {
			//my custom logic goes here
		};
	});
	</div>

	<p class="alert alert-info">Packages when in code are used in a capitalized form</p>	

</section>

<section id="angular-deps">
	<h2>Angular Modules and Dependencies</h2><span class="label label-info">Abstraction</span>|<span class="label label-info">Server</span>
	<p> </p>
	<p>Every package registration automatically creates a corresponding angular module of the form <i>mean.[package-name]</i></p> 

	<p>The package system injects this information into the mean init functions and allows developers to base their controllers, services, filters, directives etc on either an existing module or on their own one.</p>

	<p>In addition you are able to declare which angular dependencies you want your angular module to use.</p>

	<p>Below is an exmaple of adding an angualr dependency to our angular module.</p>

	<style>#angular-dep-example { height: 100px;font-size:16px;}</style>
	<div id="angular-dep-example"ui-ace="{ mode:'javascript', theme:'monokai'}" readonly="true">
	// Example of adding an angular dependency of the ngDragDrop to the 
	MyPackage.angularDependencies(['ngDragDrop']);
	</div>	

	<p class="alert alert-info">See the assets section for an example how to add external libraries to the client such as the ngDragDrop javascript library</p>	

</section>

<section id="assets">
	<h2>Assets and Aggregation</h2><span class="label label-info">Abstraction</span>|<span class="label label-info">Server</span>
	<p> </p>
	<p>All assets such as images, javascript libraries and css stylesheets should be within <i>public/assets</i> of the package file structure.</p> 

	<p>Javascript and css from <i>assets</i> can be aggregated to the global aggregation files. By default all javascript is automatically wrapped within an annonymous function unless given the option <i>{global:true}</i> to not enclose the javascript within a contained scope</p>

	<style>#assets-example { height: 220px;font-size:16px;}</style>
	<div id="assets-example"ui-ace="{ mode:'javascript', theme:'monokai'}" readonly="true">
	
	//Adding jquery to the mean project
	MyPackage.aggregateAsset('js','jquery.min.js');

	//Adding another library - global by default is false
	MyPackage.aggregateAsset('js','jquery.min.js', {global:true});

	//Adding some css to the mean project
	MyPackage.aggregateAsset('css','default.css');	
	</div>	
	
	<p class="alert alert-warning">Javascript files outside of assets are automatically aggregated and injected into the mean project. As a result libraries that you do not want aggregated should be placed within public/assets/js</p>
</section>

<section id="settings">
	<h2>Settings Object</h2><span class="label label-info">Abstraction</span>|<span class="label label-info">Server</span>
	<p> </p>
	<p>The settings object is a persistance object that is stored in the packages collection and allows for saving persistant information per package such as configuration options or admin settings for the package</p> 

	<style>#settings-example { height: 320px;font-size:16px;}</style>
	<div id="settings-example"ui-ace="{ mode:'javascript', theme:'monokai'}" readonly="true">

	//Receives two arguments the first being the settings object the second
	//is a callback function
    MyPackage.settings({'someSetting':'some value'},function (err, settings) {
      //you will receive the settings object on success
    });

    // Another save settings example this time with no callback
    // This writes over the last settings.
    MyPackage.settings({'anotherSettings':'some value'});

    // Get settings. Retrieves latest saved settigns
    MyPackage.settings(function (err, settings) {
      //you now have the settings object
    });	
	</div>	

	<p class="alert alert-warning">Each time you save settings you overwrite your previous value. Settings are designed to be used to store basic configuration options and should not be used as a large data store</p>
</section>

<section id="express-routes">
	<h2>Express Routes</h2><span class="label label-info">Abstraction</span>|<span class="label label-info">Server</span>
	<p> </p>
	<p>All routing to server side controllers is handled by express routes. The package system uses the typical express
	approach. The package system has a route function that passes along the package object to the main routing file typically <i>server/routes/index.js</i></p> 

	<p>Example from the <b>app.js</b></p>
	<style>#express1-example { height: 130;font-size:16px;}</style>
	<div id="express1-example"ui-ace="{ mode:'javascript', theme:'monokai'}" readonly="true">
	//By default the Package Object is passed to the routes along withe the other arguments
	MyPackage.routes(app, auth, database);		
	</div>	

	<p>Example from the <b>server/routes/index.js</b></p>
	<style>#express2-example { height: 210px;font-size:16px;}</style>
	<div id="express2-example"ui-ace="{ mode:'javascript', theme:'monokai'}" readonly="true">
	// The Package is past automatically as first parameter
	module.exports = function(MyPackage, app, auth, database) {

		//example route
		app.get('/myPackage/example/anyone', function (req,res,next) {
			res.send('Anyone can access this');
		});

	};		
	</div>	
</section>


	<h3>Adding a menu item</h3>


	<h3>View Rendering</h3>



<h3>Angular routes</h3>	




<section id="routes">
  <h2>Using Express Routes</h2>
</section>

<section id="angular">
  <h2>Angular Modules and Dependencies/h2>
</section>

<section id="menus">
  <h2>Menu System</h2>
</section>



<section id="publishing">
  <h2>Publishing your packages</h2>
</section>
